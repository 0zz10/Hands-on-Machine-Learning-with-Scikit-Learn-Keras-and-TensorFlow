---

title: Chapter 7. Ensemble Learning & Random Forests
keywords: fastai
sidebar: home_sidebar


---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 07.Ensembles_RFs.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width: 50%;" file="static/imgs/Hard_voting.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">sklearn</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">VotingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="k">import</span> <span class="n">SVC</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">log_clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">)</span>
<span class="n">rf_clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">svm_clf</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="s1">&#39;scale&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">make_moons</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_val</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((6700, 2), (6700,), (3300, 2), (3300,))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">voting_clf</span> <span class="o">=</span> <span class="n">VotingClassifier</span><span class="p">(</span><span class="n">estimators</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;lr&#39;</span><span class="p">,</span> <span class="n">log_clf</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;rf&#39;</span><span class="p">,</span> <span class="n">rf_clf</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;svc&#39;</span><span class="p">,</span> <span class="n">svm_clf</span><span class="p">)],</span> <span class="n">voting</span><span class="o">=</span><span class="s1">&#39;hard&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">voting_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>VotingClassifier(estimators=[(&#39;lr&#39;, LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,
          intercept_scaling=1, max_iter=100, multi_class=&#39;warn&#39;,
          n_jobs=None, penalty=&#39;l2&#39;, random_state=None, solver=&#39;lbfgs&#39;,
          tol=0.0001, verbose=0, warm_start=False)), (&#39;rf&#39;, RandomF...,
  max_iter=-1, probability=False, random_state=None, shrinking=True,
  tol=0.001, verbose=False))],
         flatten_transform=None, n_jobs=None, voting=&#39;hard&#39;, weights=None)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Let's take a look at the performance of each classifier + ensemble method on the validation set:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">accuracy_score</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">clf</span> <span class="ow">in</span> <span class="p">[</span><span class="n">log_clf</span><span class="p">,</span> <span class="n">rf_clf</span><span class="p">,</span> <span class="n">svm_clf</span><span class="p">,</span> <span class="n">voting_clf</span><span class="p">]:</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_hat</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_hat</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>LogisticRegression 0.8027272727272727
RandomForestClassifier 0.7884848484848485
SVC 0.8163636363636364
VotingClassifier 0.8142424242424242
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>There you have it! The voting classifier slightly outperforms the individual classifiers.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>If all ensemble method learners can estimate class probabilities, you can average their probabilities per class then predict the class with the highest probability.<ul>
<li>This is called <strong>Soft voting</strong>.</li>
<li>It often yields results better than hard voting because it weights confidence.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width: 50%;" file="static/imgs/bagging.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Bagging-&amp;-Pasting-in-Scikit-Learn">Bagging &amp; Pasting in Scikit-Learn<a class="anchor-link" href="#Bagging-&amp;-Pasting-in-Scikit-Learn">&#182;</a></h3><ul>
<li>Let's implement bagging in scikit-learn:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">BaggingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="k">import</span> <span class="n">DecisionTreeClassifier</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bag_clf</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bag_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>BaggingClassifier(base_estimator=DecisionTreeClassifier(class_weight=None, criterion=&#39;gini&#39;, max_depth=None,
            max_features=None, max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, presort=False, random_state=None,
            splitter=&#39;best&#39;),
         bootstrap=True, bootstrap_features=False, max_features=1.0,
         max_samples=100, n_estimators=500, n_jobs=-1, oob_score=False,
         random_state=None, verbose=0, warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_hat</span> <span class="o">=</span> <span class="n">bag_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width:66%;" file="static/imgs/dt_bagging.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Out-of-Bag-Evaluation">Out-of-Bag Evaluation<a class="anchor-link" href="#Out-of-Bag-Evaluation">&#182;</a></h3><ul>
<li>With bagging, some instances will be sampled several times for several predictors, while others won't be sampled at all.</li>
<li>Only about 63% of the instances are sampled for each predictor.</li>
<li>The other 37% of instances not sampled are called Out-of-Bag (oob) instances. <ul>
<li>Note that they're not the same 37% for all predictors.</li>
</ul>
</li>
<li>Since the individual predictor never sees the oob samples, it can be evaluated on the oob data without the need for a separate validation set.</li>
<li>You can evaluate the ensemble itself by averaging the oob scores of each predictor.</li>
<li>Let's do this using scikit-learn:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bag_clf</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="mf">0.63</span><span class="p">,</span> <span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bag_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>BaggingClassifier(base_estimator=DecisionTreeClassifier(class_weight=None, criterion=&#39;gini&#39;, max_depth=None,
            max_features=None, max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, presort=False, random_state=None,
            splitter=&#39;best&#39;),
         bootstrap=True, bootstrap_features=False, max_features=1.0,
         max_samples=0.63, n_estimators=500, n_jobs=-1, oob_score=True,
         random_state=None, verbose=0, warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bag_clf</span><span class="o">.</span><span class="n">oob_score_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.7995522388059702</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's verify this estimation using the validation set:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_hat</span> <span class="o">=</span> <span class="n">bag_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_hat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.8003030303030303</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Close enough!</li>
<li>The oob decision function is also available using scikit-learn's API, since our classifier is a decision tree then the decision function is a ratio that can be expressed as a probability, let's take a look at it for each instance:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bag_clf</span><span class="o">.</span><span class="n">oob_decision_function_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[1.        , 0.        ],
       [0.        , 1.        ],
       [0.48175182, 0.51824818],
       ...,
       [0.        , 1.        ],
       [0.23297491, 0.76702509],
       [0.2055336 , 0.7944664 ]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Random-Patches-&amp;-Random-Subspaces">Random Patches &amp; Random Subspaces<a class="anchor-link" href="#Random-Patches-&amp;-Random-Subspaces">&#182;</a></h2><ul>
<li>We can sample features as well.</li>
<li>Sampling is controlled by two hyper-parameters: <code>max_features</code> &amp; <code>bootstrap_features</code>.</li>
<li>Thus, each predictor will be trained on a random feature sample.</li>
<li>This technique is especially useful when you're dealing with high-dimensional input as as imagery. </li>
<li>Sample both instances and features is called the random patches method.</li>
<li>Sampling only features is called the random subspaces method.</li>
<li>Sampling features results in a more predictor diversity.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Random-Forests">Random Forests<a class="anchor-link" href="#Random-Forests">&#182;</a></h2><ul>
<li>A random forest is an ensemble of decision trees.</li>
<li>Let's use its scikit-learn implementation:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rnd_clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">max_leaf_nodes</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rnd_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(bootstrap=True, class_weight=None, criterion=&#39;gini&#39;,
            max_depth=None, max_features=&#39;auto&#39;, max_leaf_nodes=16,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=500, n_jobs=-1,
            oob_score=False, random_state=None, verbose=0,
            warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred_rf</span> <span class="o">=</span> <span class="n">rnd_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>The following <code>BaggingClassifier</code> is roughly equivalent to the previous <code>RandomForestClassifier</code>:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bag_clf</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span>
    <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">splitter</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">max_leaf_nodes</span><span class="o">=</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Extra-Trees">Extra-Trees<a class="anchor-link" href="#Extra-Trees">&#182;</a></h3><ul>
<li>When you are growing a tree in a random forest, only a subset of features are considered when splitting.</li>
<li>It's possible to make the trees more random by choosing different threshold of the features rather than searching for the best possible threshold.<ul>
<li>Such a model is called <strong>Extremely Randomized Trees Ensemble</strong>.</li>
</ul>
</li>
<li>When don't really know if an extremely randomized trees model will or will not outperform a classical random forest model.<ul>
<li>Generally, the only way to know is to try both and check their results using cross validation.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Feature-Importance">Feature Importance<a class="anchor-link" href="#Feature-Importance">&#182;</a></h3><ul>
<li>Yet another great quality of random forests is that they make it so easy to measure the importance of each feature.</li>
<li>We measure the importance by averaging the reduced impurity of each node that uses a certain feature across all trees in the forest.<ul>
<li>More exactly it's a weighted average beacuse each node has a number of samples that is used to weight.</li>
</ul>
</li>
<li>Let's get feature importance using random forests on the iris dataset:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="k">import</span> <span class="n">load_iris</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rnd_clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rnd_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">iris</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(bootstrap=True, class_weight=None, criterion=&#39;gini&#39;,
            max_depth=None, max_features=&#39;auto&#39;, max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=500, n_jobs=-1,
            oob_score=False, random_state=None, verbose=0,
            warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;feature_names&#39;</span><span class="p">],</span> <span class="n">rnd_clf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>sepal length (cm) 0.10463073991634259
sepal width (cm) 0.025739390903988114
petal length (cm) 0.44622243449796706
petal width (cm) 0.42340743468170294
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Let's plot pixel-wise MNIST feature importance:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="k">import</span> <span class="n">load_digits</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">digits</span> <span class="o">=</span> <span class="n">load_digits</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rnd_clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rnd_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">digits</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">digits</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(bootstrap=True, class_weight=None, criterion=&#39;gini&#39;,
            max_depth=None, max_features=&#39;auto&#39;, max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=500, n_jobs=-1,
            oob_score=False, random_state=None, verbose=0,
            warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rnd_clf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Random Forest are very handy to get a quick understanding of what features actually matter, particularly if you need to perform feature selection.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Boosting">Boosting<a class="anchor-link" href="#Boosting">&#182;</a></h2><ul>
<li>Boosting refers to any ensemble method that can combine several weak learners into a strong learner.</li>
<li>The general idea of most boosting methods is to train predictors sequentially, each trying to correct its predecessor. </li>
<li>There are many boosting methods available, but by far the most popular one is <strong>AdaBoost</strong> (Adaptive boosting) and <strong>gradient boosting</strong>.</li>
<li>Let's start with Adaboost:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width:50%;" file="static/imgs/adaboost.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">AdaBoostClassifier</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ada_clf</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> 
                             <span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;SAMME.R&#39;</span><span class="p">,</span> 
                             <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ada_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>AdaBoostClassifier(algorithm=&#39;SAMME.R&#39;,
          base_estimator=DecisionTreeClassifier(class_weight=None, criterion=&#39;gini&#39;, max_depth=1,
            max_features=None, max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, presort=False, random_state=None,
            splitter=&#39;best&#39;),
          learning_rate=0.5, n_estimators=200, random_state=None)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">accuracy_score</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">ada_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">),</span> <span class="n">y_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.8172727272727273</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Gradient-Boosting">Gradient Boosting<a class="anchor-link" href="#Gradient-Boosting">&#182;</a></h3><ul>
<li>Just like Adaboost, Gradient Boosting works by sequentially adding predictors to an ensemble each one correcting its predecessor.</li>
<li>However, instead of tweaking the instance weights at every iteration like Adaboost does, this method tries to fit the new predictor to the <strong>residual errors</strong> made by the previous predictor.</li>
<li>Let's go through a simple regression example, First let's fit a decision tree regressor to a synthetically generated training set:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span><span class="o">/</span><span class="mf">50.</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>  <span class="c1"># 1 feature</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="k">import</span> <span class="n">DecisionTreeRegressor</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_reg1</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_reg1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DecisionTreeRegressor(criterion=&#39;mse&#39;, max_depth=2, max_features=None,
           max_leaf_nodes=None, min_impurity_decrease=0.0,
           min_impurity_split=None, min_samples_leaf=1,
           min_samples_split=2, min_weight_fraction_leaf=0.0,
           presort=False, random_state=None, splitter=&#39;best&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Next, we'll train a second decision tree regressor on the errors made by the first tree:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y2</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">tree_reg1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_reg2</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_reg2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DecisionTreeRegressor(criterion=&#39;mse&#39;, max_depth=2, max_features=None,
           max_leaf_nodes=None, min_impurity_decrease=0.0,
           min_impurity_split=None, min_samples_leaf=1,
           min_samples_split=2, min_weight_fraction_leaf=0.0,
           presort=False, random_state=None, splitter=&#39;best&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Now we train a third regressor on the errors made by the second regressor:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y3</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">tree_reg2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_reg3</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_reg3</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DecisionTreeRegressor(criterion=&#39;mse&#39;, max_depth=2, max_features=None,
           max_leaf_nodes=None, min_impurity_decrease=0.0,
           min_impurity_split=None, min_samples_leaf=1,
           min_samples_split=2, min_weight_fraction_leaf=0.0,
           presort=False, random_state=None, splitter=&#39;best&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Now we have an ensemble containing three trees. It can make predictions on a new instance simply by adding up the predictions of all the trees:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="p">(</span><span class="n">tree_reg1</span><span class="p">,</span> <span class="n">tree_reg2</span><span class="p">,</span> <span class="n">tree_reg3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width:66%;" file="static/imgs/boosting_ensembles.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">GradientBoostingRegressor</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gbrt</span> <span class="o">=</span> <span class="n">GradientBoostingRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gbrt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>GradientBoostingRegressor(alpha=0.9, criterion=&#39;friedman_mse&#39;, init=None,
             learning_rate=1.0, loss=&#39;ls&#39;, max_depth=2, max_features=None,
             max_leaf_nodes=None, min_impurity_decrease=0.0,
             min_impurity_split=None, min_samples_leaf=1,
             min_samples_split=2, min_weight_fraction_leaf=0.0,
             n_estimators=3, n_iter_no_change=None, presort=&#39;auto&#39;,
             random_state=None, subsample=1.0, tol=0.0001,
             validation_fraction=0.1, verbose=0, warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width:66%;" file="static/imgs/ensemble_overunderfit.png" %}</p>

</div>
</div>
</div>
</div>
 

