---

title: Chapter 8. Dimensionality Reduction
keywords: fastai
sidebar: home_sidebar


---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 08.Dim_Reduction.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Many ML problems will involve thousands or even millions of features per instance.</li>
<li>Not only all of these features make training extremly slow, but they can also make it much harder for an optimization method to find a good solution.</li>
<li>This problem is often referred to as the <strong>curse of dimensionality</strong>.</li>
<li>In real world problem, it is often possible to reduce the number of features considerably.<ul>
<li>Turning an intractable problem into a tractable one.</li>
</ul>
</li>
<li>The goal is to remove the maximum number of features while minimizing information loss that relates to a specific task<ul>
<li>Task example â€” Classifying MNIST digits.</li>
</ul>
</li>
<li>Reducing dimensionality does cause some information loss.</li>
<li>It also makes your pipeline a bit more complex and thus harder to maintain.</li>
<li>Dimensionality reduction is usually conducted to <strong>speed up training</strong>.</li>
<li>Dimensionality reduction is also extremly useful for data visualization.<ul>
<li>Taking it down to 2/3 dimensions for your data set will allow you visualize it in a 2/3D space.</li>
</ul>
</li>
<li>DataViz is also important to communicate your findings to people who are not data scientists.<ul>
<li>In Particular, decision makers who will use your results.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>In this chapter we will:<ul>
<li>Discuss the curse of dimenstionality.</li>
<li>Get a sense of what goes on in a high-dimenstional space.</li>
<li>Consider the main two approaches to dimensionality reduction:<ul>
<li>Projection</li>
<li>Manifold Learning</li>
</ul>
</li>
<li>Go through 3 popular dimensionality reduction techniques:<ul>
<li>PCA</li>
<li>Kernel PCA</li>
<li>LLE</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Curse-of-Dimensionality">The Curse of Dimensionality<a class="anchor-link" href="#The-Curse-of-Dimensionality">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>We are so used to living in three dimensions<ul>
<li>4 if you consider time, and a few more if you are a string theorist.</li>
</ul>
</li>
<li>It turns out that many things behave very differently in high-dimensional spaces.</li>
<li>If you pick a random point in a unit square, it will have ~0.4% chance of being located at &lt;0.001 from a border.</li>
<li>But in a 1,000-dimensional hyper-cube the probability is &gt;99.999999%.<ul>
<li>Most points in a high-dimensional space are very close to the border.</li>
</ul>
</li>
<li>Same goes to distances betweeen points, If you pick two random points in a lower dimensional space, they will be closer in comparison to picking them from a high-dimensional space.</li>
<li><strong>There is just plenty of space in a high-dimensional one!</strong></li>
<li>High-dimensional datasets are at risk of being too sparse.</li>
<li>The most dimensions a dataset has, the more risk it is to overfit it.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Main-Approaches-to-Dimensionality-Reduction">Main Approaches to Dimensionality Reduction<a class="anchor-link" href="#Main-Approaches-to-Dimensionality-Reduction">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Projection">Projection<a class="anchor-link" href="#Projection">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width:50%" file="static/imgs/subspace_projection.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Manifold-Learning">Manifold Learning<a class="anchor-link" href="#Manifold-Learning">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width:50%" file="static/imgs/manifold_classification.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="PCA">PCA<a class="anchor-link" href="#PCA">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Principal Component Analysis is by far the most popular dimensionality reduction algorithm.</li>
<li>First, <strong>It identifies the hyperplane that lies closest to the data</strong>.</li>
<li>Then, <strong>It projects the data into it</strong>.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Preserving-the-Variance">Preserving the Variance<a class="anchor-link" href="#Preserving-the-Variance">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width:66%" file="static/imgs/2D_variance_projection.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Principle-Components">Principle Components<a class="anchor-link" href="#Principle-Components">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>PCA identifies the axis that accounts for the largest amount of variance in the training set.</li>
<li>It also finds a second axis, orthogonal to the first one, that accounts for the largest amount of remaining variance.</li>
<li>If we're considering a higher-dimensional dataset, PCA would also find a third axis, and a fourth, and a fifth, and so on...<ul>
<li>As many axes as the number of dimensions in the dataset.</li>
</ul>
</li>
<li>The ith axis is called the ith <strong>principal component</strong> of the data.</li>
<li>So how can you find the principal components of a training set?</li>
<li>There is a standard matrix vectorization technique called <em>Singular Value Decomposition (SVD)</em><ul>
<li>It can decompose the training set $X$ into $X=U \Sigma V^T$</li>
<li>$V$ contains the unit vectors that define all the principal components that we are looking for:</li>
</ul>
</li>
</ul>
$$V=
  \begin{pmatrix}
    \vert &amp; \vert &amp; \dots &amp; \vert \\
    c_1 &amp; c_2 &amp; \dots &amp; c_n \\
    \vert &amp; \vert &amp; \dots &amp; \vert \\
  \end{pmatrix}
$$<ul>
<li>let's extract the principal components of a dataset using numpy's <code>svd</code> implementation:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Let's start by generating some data:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">sklearn</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">X</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="mf">7.</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((100,), (100,))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$X_1$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$X_2$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(100, 2)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_centered</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">X_centered</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c1</span> <span class="o">=</span> <span class="n">Vt</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">Vt</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([0.68380192, 0.72966769]), array([-0.72966769,  0.68380192]))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>These two 2D points represent the unit vector points (origin at (0,0)) corresponding to the 2 principal components (axes that preserve variance).</li>
<li>PCA assumes that the dataset is centered around the origin, but scikit-learn implementation takes care of centering the data for you.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Projecting-down-to-$d$-Dimensions">Projecting down to $d$ Dimensions<a class="anchor-link" href="#Projecting-down-to-$d$-Dimensions">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Once you have identified all the principal components, you can reduce the dimensionality of the dataset down to $d$ dimensions by projecting it onto the hyperplane defined by the first $d$ principal components.</li>
<li>Selecting this hyperplane ensures that the projection will preserve as much variance as possible.</li>
<li>To Project the training set into the hyperplane and obtain a reduced dataset $X_{d-proj}$ of dimensionality $d$:<ul>
<li>Compute the matrix multiplication of the training set matrix $X$ by the matrix $W_{d}$ <ul>
<li>$W_{d}$ is the matrix containing the first $d$ columns of $V$ representing the principal components.</li>
</ul>
</li>
</ul>
</li>
</ul>
$$X_{d-proj}=XW_d$$<ul>
<li>Let's do it in Python:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">W2</span> <span class="o">=</span> <span class="n">Vt</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X2D</span> <span class="o">=</span> <span class="n">X_centered</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">W2</span><span class="p">)</span>
<span class="n">X2D</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(100, 2)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Using-Scikit-Learn">Using Scikit-Learn<a class="anchor-link" href="#Using-Scikit-Learn">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X2D</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">components_</span> <span class="o">==</span> <span class="n">W2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AssertionError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-15-ca99d4672c43&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">assert</span> np<span class="ansi-blue-fg">.</span>all<span class="ansi-blue-fg">(</span>pca<span class="ansi-blue-fg">.</span>components_ <span class="ansi-blue-fg">==</span> W2<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">AssertionError</span>: </pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Explained-Variance-Ratio">Explained Variance Ratio<a class="anchor-link" href="#Explained-Variance-Ratio">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>The ratio indicates the proportion of the dataset's variance lying along each principal component.</li>
<li>Let's take a look at it for our scikit-learn learner:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Choosing-the-Right-Number-of-Dimensions">Choosing the Right Number of Dimensions<a class="anchor-link" href="#Choosing-the-Right-Number-of-Dimensions">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Choose the number of dimensions that add up to a large portion of the variance that lied within the original dataset.<ul>
<li>Example: $&gt;=95\%$</li>
</ul>
</li>
<li>Unless, ofcoures, you are reducing dimensionality to visualize the data.<ul>
<li>In that case you will want to reduce the data down to 2/3 axis.</li>
</ul>
</li>
<li>Let's do it in scikit-learn:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">cumsum</span> <span class="o">&gt;=</span> <span class="o">.</span><span class="mi">95</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Then re-run PCA training using $d$.</li>
<li>But there is a much better option, that of specifying a float for <code>n_components</code> as the ratio of variance we want to preserve.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_reduced</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="PCA-for-Compression"><code>PCA</code> for Compression<a class="anchor-link" href="#PCA-for-Compression">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>After dimensionality reduction, the training set takes much less space.</li>
<li>It is also possible to decompress the reduced dataset back to $784$ (in the case of MNIST) by applying <strong>the inverse transformation of the PCA projection</strong>.<ul>
<li><strong>This won't give you back the original data since 5% of the variance was lost while compressing</strong>.</li>
<li>But it will likely be close to the original dataset.</li>
</ul>
</li>
<li><strong>The mean squared distance between the original dataset and the decompressed dataset is called the Reconstruction Error</strong>.</li>
<li>Let's do it with scikit-learn:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_openml</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;mnist_784&#39;</span><span class="p">,</span> <span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((46900, 784), (23100, 784), (46900,), (23100,))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">154</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_reduced</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_recovered</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">X_reduced</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAADnCAYAAADl9EEgAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAF60lEQVR4nO3dP2uTexzG4cY/UAWpghGqiPgKBBEEQagiooOoHeosOnTRxUWHLgqKrqWT6OwoXXwNVosgKIhuCoLiLEVpz3ag0Oeb0yY5vdNc1+jNkzwIHx7ojyStlZWVESDPts2+AWBt4oRQ4oRQ4oRQ4oRQOzrs/pQL/dda6x89OSGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCGUOCHUjs2+gUG0vLxc7p8/f97way8tLZX71NRUuR87dqzcX758We5nz55t3C5dulReOz09Xe7btnkWrIf/LQglTgglTgglTgglTgglTgglTgjlnHMN379/L/dO53nz8/O9vJ11+fTpU1fXv379unHrdIa6srLS1XuzmicnhBInhBInhBInhBInhBInhBrKo5ROf/Kfm5sr9808Kmm1WuW+c+fOcn/79m2579+/v3EbHx8vr6W3PDkhlDghlDghlDghlDghlDghlDghVKvDmd+W/AzQ7Oxsud++fbuv73/06NHGbWJiory209dTXr16dSO3xOZa8/DakxNCiRNCiRNCiRNCiRNCiRNCiRNCDeXnOT98+NDV9TMzM+V+5syZcj9+/HjjNjY2tqF7Yuvx5IRQ4oRQ4oRQ4oRQ4oRQ4oRQ4oRQQ3nOWZ0z/hc3btwo9yNHjnT1+jAy4skJscQJocQJocQJocQJocQJocQJoYbynPPUqVNdXT85OVnuT58+Lfd9+/Y1btV32jJcPDkhlDghlDghlDghlDghlDgh1FD+BODXr1/L/cSJE+X+48ePrt6/3W43btevXy+vffz4cVfvTSQ/AQiDRJwQSpwQSpwQSpwQSpwQSpwQaijPOTtZXFws9ytXrpT7z58/y31paalxGx0dLa+9d+9euXeya9eucp+enm7c9uzZ09V708g5JwwScUIocUIocUIocUIocUIocUIo55x9MD8/X+537txp3L58+dLr21mXAwcONG7Pnj0rr7148WK5b9++fUP3NAScc8IgESeEEieEEieEEieEEieEEieEcs65CX79+tW4ffz4sbz20aNH5f7q1asN3VMv3L17t9w73fsQc84Jg0ScEEqcEEqcEEqcEEqcEEqcEMo554D5+/dvuT9//rzcz58/X+7Xrl1r3BYWFsprW601j+v+9eLFi3Kfmpoq9y3MOScMEnFCKHFCKHFCKHFCKHFCKEcprFL9fOHc3Fx57YMHD8q93W6X+5s3bxq3w4cPl9cOOEcpMEjECaHECaHECaHECaHECaHECaGcc9Izu3fvLvffv3+X+8zMTON2//79Dd3TgHDOCYNEnBBKnBBKnBBKnBBKnBBKnBBqx2bfAFmqnydcXFwsr+30tZ2dVJ8lHUaenBBKnBBKnBBKnBBKnBBKnBBKnBDKOeeQefLkSbnPzs42bt++fev17axy6NChvr7+oPHkhFDihFDihFDihFDihFDihFC+GnOLefjwYblXXz85MjIysry83MvbWaXTUcnCwkLjdvDgwV7fThJfjQmDRJwQSpwQSpwQSpwQSpwQSpwQykfG+uDdu3flfvLkyb69958/f/r22p3OKScmJsr98uXL5b7FzzLXzZMTQokTQokTQokTQokTQokTQokTQjnn7IMOn5Ht61nk+Ph4uV+4cKHcJycnG7fTp0+X146NjZU76+PJCaHECaHECaHECaHECaHECaHECaGcc/ZBu90u91u3bjVu79+/L689d+5cud+8ebPcR0dHy33v3r3lzv/HkxNCiRNCiRNCiRNCiRNCiRNCiRNC+X1O2Hx+nxMGiTghlDghlDghlDghlDghlDghlDghlDghlDghlDghlDghlDghlDghlDghlDghlDghlDghlDghlDghlDghlDghVKefAFzzK/uA/vPkhFDihFDihFDihFDihFDihFD/AFge3VCQm84tAAAAAElFTkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_recovered</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Following is the equation of the inverse transformation:</li>
</ul>
$$X_{recovered}=X_{d-proj}W_{d}^{T}$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Randomized-PCA">Randomized PCA<a class="anchor-link" href="#Randomized-PCA">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>We can use a stochastic algorithm called <em>Randomized PCA</em> that quickly finds an approximation of the first $d$ principal components.</li>
<li>Its computational complexity is $O(m \times d^{2})+O(d^3)$ instead of SVD's $O(m \times n^{2})+O(n^3)$.</li>
<li>So it's dramatically faster then SVD when $d &lt;&lt; n$.</li>
<li>Let's use it with <code>scikit-learn</code>:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rnd_pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">154</span><span class="p">,</span> <span class="n">svd_solver</span><span class="o">=</span><span class="s1">&#39;randomized&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_reduced</span> <span class="o">=</span> <span class="n">rnd_pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Incremental-PCA">Incremental PCA<a class="anchor-link" href="#Incremental-PCA">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>One problem with the previous implementations of PCA is that they require the whole training data to fit in memory.</li>
<li>Fortunately, <strong>incremental PCA</strong> algorithms have been developed.</li>
<li>They allow us to split the training set in mini-batches and feed them one at a time to the IPCA algorithm.</li>
<li>This is useful when having large training sets or doing online learning.</li>
<li>Let's experiment with incremental PCA using scikit-learn:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">IncrementalPCA</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_batches</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">inc_pca</span> <span class="o">=</span> <span class="n">IncrementalPCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">154</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">X_batch</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">n_batches</span><span class="p">):</span>
    <span class="n">inc_pca</span><span class="o">.</span><span class="n">partial_fit</span><span class="p">(</span><span class="n">X_batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_reduced</span> <span class="o">=</span> <span class="n">inc_pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>We can also mimic normal fitting behavior by using the <code>memap</code> class to store our training data:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Kernel-PCA">Kernel PCA<a class="anchor-link" href="#Kernel-PCA">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Recall that a linear decision boundary in a high-dimensional space corresponds to a non-linear decision boundary in the original low-dimensional space.</li>
<li>It turns out that the "kernel trick" can also be applied to PCA.</li>
<li>Making it possible to perform complex non-linear projections for dimensionality reduction.</li>
<li>It's often <strong>good at preserving clusters of instances after projecting them</strong>.</li>
<li>Let's use kPCA in scikit-learn:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">KernelPCA</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rbf_pca</span> <span class="o">=</span> <span class="n">KernelPCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_reduced</span> <span class="o">=</span> <span class="n">rbf_pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Selecting-a-Kernel-and-Tuning-Hyperparameters">Selecting a Kernel and Tuning Hyperparameters<a class="anchor-link" href="#Selecting-a-Kernel-and-Tuning-Hyperparameters">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><em>Note: Use a GPU</em></li>
<li>As kPCA is an unsupervised learning algorithm, there is no obvious performance measure to help you select the best kernel and hyper-parameter values.</li>
<li>That said, dimensionality reduction is often a pre-processing step for a supervised learning task.</li>
<li>So you can use grid search to select the kernel and hyper-parameters that lead to the best performance on the end task.</li>
<li>The following scikit-learn example create a two step pipeline:<ul>
<li>First reducing the dimensionality to 2 dimensions using kPCA.</li>
<li>Then Applying logistic regression for classification.</li>
</ul>
</li>
<li>Then we use <code>GridSearchCV</code> to find the best <strong>kernel</strong> and <strong>gamma</strong> value for kPCA in order to get the best classification accuracy at the end of the pipeline.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;kpca&#39;</span><span class="p">,</span> <span class="n">KernelPCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)),</span>
    <span class="p">(</span><span class="s1">&#39;log_reg&#39;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">())</span>
<span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">param_grid</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s2">&quot;kpca__gamma&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="s2">&quot;kpca__kernel&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;rbf&quot;</span><span class="p">,</span> <span class="s2">&quot;sigmoid&quot;</span><span class="p">]</span>
<span class="p">}]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width:50%" file="static/imgs/reconstruction_vis.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rbf_pca</span> <span class="o">=</span> <span class="n">KernelPCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.0433</span><span class="p">,</span> <span class="n">fit_inverse_transform</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_reduced</span> <span class="o">=</span> <span class="n">rbf_pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_preimage</span> <span class="o">=</span> <span class="n">rbf_pca</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">X_reduced</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X_preimage</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>You can you grid search to find the hyper-parameters that minimize this error.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="LLE">LLE<a class="anchor-link" href="#LLE">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Locally Linear Embedding is a powerful non-linear dimensionality reduction technique.</li>
<li>It's a manifold learning technique that doesn't rely on projections like the previous algorithms do.</li>
<li>LLE works by first measuring how each instance relates to its neighbors</li>
<li>Then it looks for low-dimensional representation of the training set where each local relationship is best preserved.</li>
<li>Let's use it with scikit-learn:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">LocallyLinearEmbedding</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lle</span> <span class="o">=</span> <span class="n">LocallyLinearEmbedding</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_reduced</span> <span class="o">=</span> <span class="n">lle</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width:50%" file="static/imgs/swiss_unroll.png" %}</p>

</div>
</div>
</div>
</div>
 

